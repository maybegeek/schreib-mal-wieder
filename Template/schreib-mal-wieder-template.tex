\documentclass[fontsize=12pt,DIV=10,paper=a4,twoside=false]{scrartcl}

\usepackage{xunicode}

\usepackage{polyglossia}
\setdefaultlanguage[spelling=new]{german}
\setmainlanguage[babelshorthands=false]{german}
%\usepackage[autostyle,german=guillemets]{csquotes}
\usepackage[autostyle,german=quotes]{csquotes}
\MakeOuterQuote{"}
$if(PstLang)$\setotherlanguage{$PstLang$}$else$$endif$

\usepackage{rotating}
\usepackage{xcolor}
\usepackage{dashrule}
\usepackage{adjustbox}
\usepackage{comment}
\usepackage{shapepar}
\usepackage[absolute]{textpos}
\usepackage{intcalc}
\usepackage{xstring}
\usepackage{forloop}
\usepackage{xltxtra}
\usepackage{fixltx2e}
\usepackage{ifthen}
\usepackage{fontspec}
\defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}

\setmainfont[%
  RawFeature=-calt,%
  Path=./Template/Fonts/EBGaramond/otf/,%
  UprightFont=EBGaramond08-Regular.otf,%
  BoldFont=EBGaramond08-Regular.otf,%
  BoldFeatures={FakeBold=1.8},%
  ItalicFont=EBGaramond08-Italic.otf,%
  BoldItalicFont=EBGaramond08-Italic.otf,%
  BoldItalicFeatures={FakeBold=1.8},%
  SmallCapsFont=EBGaramondSC08-Regular.otf%
]{EBGaramond}

\setsansfont[%
  RawFeature=-calt,%
  Path=./Template/Fonts/EBGaramond/otf/,%
  UprightFont=EBGaramond08-Regular.otf,%
  BoldFont=EBGaramond08-Regular.otf,%
  BoldFeatures={FakeBold=1.8},%
  ItalicFont=EBGaramond08-Italic.otf,%
  BoldItalicFont=EBGaramond08-Italic.otf,%
  BoldItalicFeatures={FakeBold=1.8},%
  SmallCapsFont=EBGaramondSC08-Regular.otf%
]{EBGaramond}

%\setsansfont[%
%  Path=Template/Fonts/FiraSans/,%
%  UprightFont=*-Regular,%
%  ItalicFont=*-Italic,%
%  BoldFont=*-Bold,%
%  BoldItalicFont=*-BoldItalic%
%]{FiraSans}

\setmonofont[%
  Path=Template/Fonts/FiraMono/,%
  UprightFont=*-Regular,%
  BoldFont=*-Bold,%
  Mapping=tex-ansi,
]{FiraMono}

%\setmonofont[Mapping=tex-ansi]{Droid Sans Mono}

\newcommand{\pstBriefFont}{EBGaramond}
\newcommand{\pstFont}{EBGaramond}
\newcommand{\pstFontNeu}{EBGaramond}
\newcommand{\pstFontNull}{EBGaramond}

\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath}

\newcommand{\pstZusatzA}{}
\newcommand{\pstZusatzB}{}
\newcommand{\pstTitel}{Postkartenspielerei in Wort und Form}
\newcommand{\pstVonAutor}{$if(PstVonAutor)$$PstVonAutor$$else$maybegeek$endif$}
\newcommand{\pstAnName}{{\color{GRAU}$if(PstAnName)$$PstAnName$$else$\dotfill$endif$}}
\newcommand{\pstAnStrasse}{{\color{GRAU}$if(PstAnStrasse)$$PstAnStrasse$$else$\dotfill$endif$}}
\newcommand{\pstAnOrt}{{\color{GRAU}$if(PstAnOrt)$$PstAnOrt$$else$\dotfill$endif$}}
\newcommand{\pstAnLand}{{\color{GRAU}$if(PstAnLand)$$PstAnLand$$else$\dotfill$endif$}}
\newcommand{\pstText}{$if(PstText)$$PstText$$else$obey!$endif$}

\newcommand{\pstMaxDiv}{}
\newcommand\pstZeichenDings[1]{%
  \StrLen{#1}[\pstZeichenCounter]%
  \renewcommand{\pstMaxDiv}{\intcalcAdd{\intcalcDiv{2200}{\pstZeichenCounter}}{2}}
  %\renewcommand{\pstMaxDiv}{\intcalcDiv{2200}{\pstZeichenCounter}}
}
\pstZeichenDings{\pstText}
\newcommand\pstDerText{}
\newcounter{ct}%
\forloop{ct}{1}{\value{ct} < \pstMaxDiv}%
{ \appto\pstDerText{\pstText~} }

\newcommand{\PstFigur}{$if(PstFigur)$$PstFigur$$else$none$endif$}

\ifthenelse{\equal{\PstFigur}{lantern}}{
\StrLeft{\pstDerText}{1900}[\pstDerText]
\input{Shapes/lantern.shape}
\newcommand{\pstFormatHoch}{\lanternpar{\fontsize{6}{7}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreit}{\lanternpar{\fontsize{6}{7}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatHochFarbe}{\lanternpar{\fontsize{6}{7}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreitFarbe}{\lanternpar{\fontsize{6}{7}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\renewcommand{\pstZusatzA}{$if(PstZusatzA)$$PstZusatzA$$else$happy ...$endif$}
\renewcommand{\pstZusatzB}{$if(PstZusatzB)$$PstZusatzB$$else$der klassische runde Rübengeist :) $endif$}
}{}

\ifthenelse{\equal{\PstFigur}{catandbat}}{
\StrLeft{\pstDerText}{1900}[\pstDerText]
\input{Shapes/cat.shape}
\input{Shapes/bat.shape}
\newcommand{\pstFormatHoch}{\catpar{\fontsize{6}{7}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreit}{\batpar{\fontsize{4}{5}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatHochFarbe}{\catpar{\fontsize{6}{7}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreitFarbe}{\batpar{\fontsize{4}{5}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\renewcommand{\pstZusatzA}{$if(PstZusatzA)$$PstZusatzA$$else$cat$endif$}
\renewcommand{\pstZusatzB}{$if(PstZusatzB)$$PstZusatzB$$else$and bat$endif$}
}{}

\ifthenelse{\equal{\PstFigur}{movember}}{
\StrLeft{\pstDerText}{1900}[\pstDerText]
\input{Shapes/movember.shape}
\input{Shapes/mov.shape}
\newcommand{\pstFormatHoch}{\movpar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreit}{\movemberpar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatHochFarbe}{\movpar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreitFarbe}{\movemberpar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\renewcommand{\pstZusatzA}{$if(PstZusatzA)$$PstZusatzA$$else$Mo Sis \& Mo Bro, Movember is coming!$endif$}
\renewcommand{\pstZusatzB}{$if(PstZusatzB)$$PstZusatzB$$else$http://movember.com$endif$}
}{}

\ifthenelse{\equal{\PstFigur}{glider}}{
\StrLeft{\pstDerText}{1900}[\pstDerText]
\input{Shapes/gliderrund.shape}
\input{Shapes/glidereckig.shape}
\newcommand{\pstFormatHoch}{\glidereckigpar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreit}{\gliderrundpar{\fontsize{4}{5}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatHochFarbe}{\glidereckigpar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreitFarbe}{\gliderrundpar{\fontsize{4}{5}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\renewcommand{\pstZusatzA}{$if(PstZusatzA)$$PstZusatzA$$else$the blue one!!$endif$}
\renewcommand{\pstZusatzB}{$if(PstZusatzB)$$PstZusatzB$$else$http://....com$endif$}
}{}

\ifthenelse{\equal{\PstFigur}{umbrella}}{
\StrLeft{\pstDerText}{1900}[\pstDerText]
\input{Shapes/umbrella.shape}
\newcommand{\pstFormatHoch}{\umbrellapar{\fontsize{4}{5}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreit}{\umbrellapar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatHochFarbe}{\umbrellapar{\fontsize{4}{5}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreitFarbe}{\umbrellapar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\renewcommand{\pstZusatzA}{$if(PstZusatzA)$$PstZusatzA$$else$Schirm$endif$}
\renewcommand{\pstZusatzB}{$if(PstZusatzB)$$PstZusatzB$$else$... weil pfuiwetter$endif$}
}{}

\ifthenelse{\equal{\PstFigur}{hand}}{
\StrLeft{\pstDerText}{1900}[\pstDerText]
\input{Shapes/zombiehand.shape}
\newcommand{\pstFormatHoch}{\zombiehandpar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreit}{\zombiehandpar{\fontsize{4}{5}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatHochFarbe}{\zombiehandpar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreitFarbe}{\zombiehandpar{\fontsize{4}{5}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\renewcommand{\pstZusatzA}{$if(PstZusatzA)$$PstZusatzA$$else$walkers, sleepers, ...$endif$}
\renewcommand{\pstZusatzB}{$if(PstZusatzB)$$PstZusatzB$$else$$endif$}
}{}

\ifthenelse{\equal{\PstFigur}{herz}}{
\StrLeft{\pstDerText}{1900}[\pstDerText]
\newcommand{\pstFormatHoch}{\heartpar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreit}{\heartpar{\fontsize{4}{5}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatHochFarbe}{\heartpar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreitFarbe}{\heartpar{\fontsize{4}{5}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\renewcommand{\pstZusatzA}{$if(PstZusatzA)$$PstZusatzA$$else$bis zum Himmel ...$endif$}
\renewcommand{\pstZusatzB}{$if(PstZusatzB)$$PstZusatzB$$else$und wieder zurück.$endif$}
}{}

\ifthenelse{\equal{\PstFigur}{power}}{
\StrLeft{\pstDerText}{1900}[\pstDerText]
\input{Shapes/power.shape}
\newcommand{\pstFormatHoch}{\powerpar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreit}{\powerpar{\fontsize{4}{5}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatHochFarbe}{\powerpar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreitFarbe}{\powerpar{\fontsize{4}{5}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\renewcommand{\pstZusatzA}{$if(PstZusatzA)$$PstZusatzA$$else$geek$endif$}
\renewcommand{\pstZusatzB}{$if(PstZusatzB)$$PstZusatzB$$else$...$endif$}
}{}

\ifthenelse{\equal{\PstFigur}{urkugel}}{
\StrLeft{\pstDerText}{1900}[\pstDerText]
\input{Shapes/urkugel.shape}
\newcommand{\pstFormatHoch}{\urkugelpar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreit}{\urkugelpar{\fontsize{6}{7}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatHochFarbe}{\urkugelpar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreitFarbe}{\urkugelpar{\fontsize{6}{7}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\renewcommand{\pstZusatzA}{$if(PstZusatzA)$$PstZusatzA$$else$ur$endif$}
\renewcommand{\pstZusatzB}{$if(PstZusatzB)$$PstZusatzB$$else$ur$endif$}
}{}

\ifthenelse{\equal{\PstFigur}{urlantern}}{
\StrLeft{\pstDerText}{1900}[\pstDerText]
\input{Shapes/urlantern.shape}
\newcommand{\pstFormatHoch}{\urlanternpar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreit}{\urlanternpar{\fontsize{6}{7}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatHochFarbe}{\urlanternpar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreitFarbe}{\urlanternpar{\fontsize{6}{7}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\renewcommand{\pstZusatzA}{$if(PstZusatzA)$$PstZusatzA$$else$ur$endif$}
\renewcommand{\pstZusatzB}{$if(PstZusatzB)$$PstZusatzB$$else$creepy$endif$}
}{}

\ifthenelse{\equal{\PstFigur}{coffee}}{
\StrLeft{\pstDerText}{1900}[\pstDerText]
\input{Shapes/coffee.shape}
\newcommand{\pstFormatHoch}{\coffeepar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreit}{\coffeepar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatHochFarbe}{\coffeepar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreitFarbe}{\coffeepar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\renewcommand{\pstZusatzA}{$if(PstZusatzA)$$PstZusatzA$$else$... and the smell of the coffee bean$endif$}
\renewcommand{\pstZusatzB}{$if(PstZusatzB)$$PstZusatzB$$else$well, it just won't go away$endif$}
}{}

\ifthenelse{\equal{\PstFigur}{rosa}}{
\StrLeft{\pstDerText}{1900}[\pstDerText]
\input{Shapes/rosa.shape}
\newcommand{\pstFormatHoch}{\rosapar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreit}{\rosapar{\fontsize{4}{5}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatHochFarbe}{\rosapar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreitFarbe}{\rosapar{\fontsize{4}{5}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\renewcommand{\pstZusatzA}{$if(PstZusatzA)$$PstZusatzA$$else$11.11.$endif$}
\renewcommand{\pstZusatzB}{$if(PstZusatzB)$$PstZusatzB$$else$happy birthday$endif$}
}{}

\ifthenelse{\equal{\PstFigur}{baum}}{
\StrLeft{\pstDerText}{1900}[\pstDerText]
\input{Shapes/baum.shape}
\newcommand{\pstFormatHoch}{\baumpar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreit}{\baumpar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatHochFarbe}{\baumpar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreitFarbe}{\baumpar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\renewcommand{\pstZusatzA}{$if(PstZusatzA)$$PstZusatzA$$else$Frohe Weihnachten$endif$}
\renewcommand{\pstZusatzB}{$if(PstZusatzB)$$PstZusatzB$$else$$endif$}
}{}

\ifthenelse{\equal{\PstFigur}{xmasnumbers}}{
\StrLeft{\pstDerText}{1900}[\pstDerText]
\input{Shapes/dezimalxmas.shape}
\input{Shapes/binaryxmas.shape}
\newcommand{\pstFormatHoch}{\dezimalxmaspar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreit}{\binaryxmaspar{\fontsize{5}{6}\selectfont$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatHochFarbe}{\dezimalxmaspar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\newcommand{\pstFormatBreitFarbe}{\binaryxmaspar{\fontsize{5}{6}\selectfont\textcolor{TEXTFARBE}$if(PstLang)${\text$PstLang${\pstDerText}}$else$\pstDerText$endif$}}
\renewcommand{\pstZusatzA}{$if(PstZusatzA)$$PstZusatzA$$else$adventus domini$endif$}
\renewcommand{\pstZusatzB}{$if(PstZusatzB)$$PstZusatzB$$else$$endif$}
}{}

\title{\pstTitel}
\author{\pstVonAutor}

\definecolor{GRAU}{RGB}{139,137,137}
\definecolor{TEXTFARBE}{HTML}{$if(PstTextFarbe)$$PstTextFarbe$$else$FFF4BF$endif$}
\definecolor{HINTERGRUND}{HTML}{$if(PstHintergrundFarbe)$$PstHintergrundFarbe$$else$990000$endif$}

\newcommand{\pstBlock}{\textblockorigin{$if(PstDuplexKorrX)$$PstDuplexKorrX$mm$else$0mm$endif$}{$if(PstDuplexKorrY)$$PstDuplexKorrY$mm$else$0mm$endif$}}

\begin{document}
$for(include-before)$
$include-before$

$endfor$

\end{document}
